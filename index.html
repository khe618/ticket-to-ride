<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ticket to Random</title>
  <link rel="stylesheet" href="/style.css" />
</head>
<body>
  <div id="lobbyScreen" class="lobby-screen">
    <div class="lobby-card">
      <div class="lobby-title">Ticket to Random Lobby</div>
      <form id="lobbyJoinForm" class="lobby-join" autocomplete="off">
        <input id="lobbyNameInput" class="lobby-input" type="text" maxlength="24" placeholder="Enter your name" />
        <button id="lobbyJoinBtn" class="lobby-btn" type="submit">Join Lobby</button>
      </form>
      <div class="lobby-list-wrap" aria-label="Lobby players">
        <div class="lobby-subtitle">Players</div>
        <div id="lobbyPlayersList" class="lobby-players-list"></div>
      </div>
      <div class="lobby-actions">
        <button id="lobbyHowToPlayBtn" class="lobby-btn howto" type="button">How to Play</button>
        <button id="lobbyStartBtn" class="lobby-btn start" type="button" disabled>Start Game</button>
      </div>
      <div id="lobbyStatus" class="lobby-status"></div>
    </div>
  </div>

  <div id="gameWrap" class="wrap hidden">
    <div class="hud">
      <div class="title">Ticket to Random</div>
      <div id="routeInfo" class="route-info">Select a route</div>
      <button id="submitBtn" class="submit" disabled>Submit Route</button>
      <div class="sidebar-destination" aria-label="Your destination tickets">
        <div class="ticket-block-title">Your Destination Tickets</div>
        <div id="destinationTicketsList" class="destination-tickets-list"></div>
        <button id="drawDestinationBtn" class="submit" type="button" disabled>Draw destination tickets</button>
        <div id="ticketSelectPanel" class="ticket-select-panel hidden" aria-label="Destination ticket selection">
          <div id="ticketSelectHint" class="destination-ticket-empty">Keep at least 2 tickets.</div>
          <div id="ticketSelectList" class="destination-tickets-list selection"></div>
          <div class="ticket-select-actions">
            <button id="ticketSelectSubmit" class="modal-btn primary" disabled>Confirm Ticket Selection</button>
          </div>
        </div>
      </div>
      <div class="log-area" aria-label="Game log">
        <div class="log-title">Game Log</div>
        <div id="logList" class="log-list"></div>
      </div>
      <div id="endGameActions" class="endgame-actions hidden">
        <button id="viewResultsBtn" class="submit" type="button">View Game Results</button>
        <button id="sidebarReturnLobbyBtn" class="submit" type="button">Return to Lobby</button>
      </div>
    </div>
    <div class="stage">
      <div class="stage-inner">
        <div class="side-left">
          <div class="legend" aria-label="Scoring legend">
            <div class="legend-title">Route Scoring</div>
            <div class="legend-row"><div class="legend-blocks"><span class="legend-block"></span></div><div class="legend-score">1</div></div>
            <div class="legend-row"><div class="legend-blocks"><span class="legend-block"></span><span class="legend-block"></span></div><div class="legend-score">2</div></div>
            <div class="legend-row"><div class="legend-blocks"><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span></div><div class="legend-score">4</div></div>
            <div class="legend-row"><div class="legend-blocks"><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span></div><div class="legend-score">7</div></div>
            <div class="legend-row"><div class="legend-blocks"><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span></div><div class="legend-score">10</div></div>
            <div class="legend-row"><div class="legend-blocks"><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span><span class="legend-block"></span></div><div class="legend-score">15</div></div>
          </div>
          <div class="players" aria-label="Players">
            <div class="players-title">Players</div>
            <div id="playersList" class="players-list"></div>
          </div>
          <div id="chatPanel" class="game-chat" aria-label="Game chat">
            <div class="chat-header">
              <div class="chat-title">Chat</div>
              <button id="chatToggleBtn" class="chat-toggle" type="button" aria-expanded="true" aria-label="Hide chat">-</button>
            </div>
            <div id="chatBody" class="chat-body">
              <div id="chatMessages" class="chat-messages"></div>
              <form id="chatForm" class="chat-form" autocomplete="off">
                <input id="chatInput" class="chat-input" type="text" maxlength="220" placeholder="Type a message" />
                <button id="chatSendBtn" class="chat-send" type="submit">Send</button>
              </form>
            </div>
          </div>
        </div>
        <div id="gameBox" class="game-box">
          <svg id="mapSvg" viewBox="0 0 1000 1000" aria-label="Route map"></svg>
        </div>
        <div class="cards" aria-label="Card display">
          <img id="deckBack" class="card" src="/img/back.png" alt="Deck back" />
          <div id="faceUpCards" class="face-up"></div>
        </div>
      </div>
      <div class="ticket-area" aria-label="Your tickets">
        <div class="ticket-block">
          <div id="ticketPile" class="ticket-pile"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="colorModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="colorModalTitle">
    <div class="modal-card">
      <div id="colorModalTitle" class="modal-title">Choose Color</div>
      <div id="colorOptions" class="modal-options"></div>
      <div class="modal-actions">
        <button id="colorCancel" class="modal-btn">Cancel</button>
        <button id="colorSubmit" class="modal-btn primary" disabled>Submit</button>
      </div>
    </div>
  </div>

  <div id="gameOverModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="gameOverTitle">
    <div class="modal-card gameover-card">
      <div id="gameOverTitle" class="modal-title">Game Over</div>
      <div id="gameOverSummary" class="gameover-summary"></div>
      <div id="standingsList" class="standings-list"></div>
      <div class="modal-actions">
        <button id="gameOverCloseBtn" class="modal-btn" type="button">Close</button>
        <button id="returnLobbyBtn" class="modal-btn primary">Return to Lobby</button>
      </div>
    </div>
  </div>

  <div id="howToPlayModal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="howToPlayTitle">
    <div class="modal-card howto-card">
      <div id="howToPlayTitle" class="modal-title">How to Play</div>
      <div class="howto-content">
        <p class="howto-lead">Objective: score the most points by claiming routes and completing destination tickets.</p>

        <section class="howto-section">
          <h3>Setup</h3>
          <ul>
            <li>Each player starts with 45 trains.</li>
            <li>Each player starts with 4 random train cards.</li>
            <li>You are dealt 5 destination tickets and must keep at least 2.</li>
          </ul>
        </section>

        <section class="howto-section">
          <h3>On Your Turn</h3>
          <ul>
            <li>Do one action: draw train cards, claim one route, or draw destination tickets.</li>
            <li>If you draw destination tickets, draw up to 3 and keep at least 1. This ends your turn.</li>
          </ul>
        </section>

        <section class="howto-section">
          <h3>Claiming Routes</h3>
          <ul>
            <li>You must have enough matching cards and enough trains for that route length.</li>
            <li>When you claim a route, place trains and gain route points.</li>
            <li>Route scoring: length 1/2/3/4/5/6 gives 1/2/4/7/10/15 points.</li>
          </ul>
        </section>

        <section class="howto-section">
          <h3>Destination Tickets</h3>
          <ul>
            <li>A ticket is complete if your claimed routes connect the two ticket cities.</li>
            <li>Completed tickets add their value. Incomplete tickets subtract their value.</li>
          </ul>
        </section>

        <section class="howto-section">
          <h3>End of Game</h3>
          <ul>
            <li>If a player ends a turn with 2 or fewer trains, the final round begins.</li>
            <li>Every player gets one more turn, including the player who triggered it.</li>
            <li>Globetrotter bonus: player(s) with the most completed tickets get +10 points.</li>
            <li>Longest Road bonus: player(s) with the highest total connected road length get +15 points.</li>
          </ul>
        </section>
      </div>
      <div class="modal-actions">
        <button id="howToPlayCloseBtn" class="modal-btn primary" type="button">Close</button>
      </div>
    </div>
  </div>

  <script src="/app.js"></script>
</body>
</html>
